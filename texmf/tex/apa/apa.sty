% BibTeX `apa' style
%       for BibTeX version 0.99a
%       by David Plaut (dp28)
% This LaTeX style is for producing citations with a parenthesised
% format similar to Scribe's APA format.
% Prepared by Richard Szeliski, based on the aaai.sty format
% prepared by Peter F. Patel-Schneider.
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
%       To use:
%       \documentstyle[...,apa-dp28,...]{...}
%       \bibliographystyle{apa-dp28}
%
%  ALTERNATIVE FORMATS
%
%       \cite{SmithJones87}             =>      (Smith & Jones, 1987)
%       \outcite{SmithJones87}          =>      Smith and Jones (1987)
%               authors outside parentheses
%       \incite{...} same as \outcite{...}
%               for ``inline'' citation
%       \nopcite{SmithJones87}          =>      Smith & Jones, 1987
%               no parentheses
%       \poscite{SmithJones87}          =>      Smith and Jones' (1987)
%               possessive (' with no following s)
%       \posscite{JonesSmith87}         =>      Jones and Smith's (1987)
%               possessive ('s)
%       \yrcite{SmithJones87}           =>      (1987)
%               just year
%       \yrnopcite{SmithJones87}        =>      1987
%               just year with no parentheses
%
%  LEADING/FOLLOWING COMMENTS
%
%       \cite[see]{Smith87}             =>      (see Smith, 1987)
%               leading comment
%       \cite[][p.~20]{Smith87}         =>      (Smith, 1987, p. 20)
%               following comment
%       \cite[see][p.~20]{Smith87}      =>      (see Smith, 1987, p. 20)
%               both leading and following comments
%       also for \outcite, etc.
%
%  MULTIPLE CITATIONS OF SAME AUTHOR(S)
%
%       \cite{Smith87,Smith88,Jones89}  =>      (Smith, 1987, 1988; Jones, 1989)
%       also for \outcite, etc.
%
%  FIRST/SUBSEQUENT CITATIONS
%
%       \cite{SmithJonesDoe87}          =>      (Smith, Jones, & Doe, 1987)
%               first citation: all authors listed
%       \cite{SmithJonesDoe87}          =>      (Smith et al., 1987)
%               subsequenct citations: et al. for three or more authors
%       also for \outcite, etc.
%
%       \abbrevcite{SmithJonesDoe87}    =>      (Smith et al., 1987)
%               always use et al.
%       \fullcite{SmithJonesDoe87}      =>      (Smith, Jones, & Doe, 1987)
%               always list all authors
%       also \abbrevoutcite, etc, and \fulloutcite, etc.
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Headings
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\if@twocolumn
%\def\section{\@startsection {section}{1}{\z@}{-2.5ex plus -1ex minus 
% -.2ex}{1.3ex plus .2ex}{\Large\bf\centering}}
%\def\subsection{\@startsection{subsection}{2}{\z@}{-2.25ex plus -1ex minus 
% -.2ex}{1.0ex plus .2ex}{\large\bf}}
%\def\subsubsection{\@startsection{subsubsection}{3}{\parindent}{2.25ex plus 
% 1ex minus .2ex}{1.0ex plus .2ex}{\normalsize\bf}}
%\def\paragraph{\@startsection
% {paragraph}{4}{\parindent}{0em}{-1em}{\normalsize\bf}}
%\def\subparagraph{\@startsection
% {subparagraph}{4}{\parindent}{2.25ex plus 1ex minus 
% .2ex}{-1em}{\normalsize\em}}
%\else
%\def\section{\@startsection {section}{1}{\z@}{-3.5ex plus -1ex minus 
% -.2ex}{2.3ex plus .2ex}{\Large\bf\centering}}
%\def\subsection{\@startsection{subsection}{2}{\z@}{-3.25ex plus -1ex minus 
% -.2ex}{1.5ex plus .2ex}{\large\bf}}
%\def\subsubsection{\@startsection{subsubsection}{3}{\parindent}{3.25ex plus 
% 1ex minus .2ex}{1.5ex plus .2ex}{\normalsize\bf}}
%\def\paragraph{\@startsection
% {paragraph}{4}{\parindent}{0em}{-1em}{\normalsize\bf}}
%\def\subparagraph{\@startsection
% {subparagraph}{4}{\parindent}{3.25ex plus 1ex minus 
% .2ex}{-1em}{\normalsize\em}}
%\fi
%
%\def\@startsection#1#2#3#4#5#6{\if@noskipsec \leavevmode \fi
%   \par \@tempskipa #4\relax
%   \@afterindenttrue
%   \ifdim \@tempskipa <\z@ \@tempskipa -\@tempskipa \@afterindentfalse\fi
%   \if@nobreak \everypar{}\else
%     \addpenalty{\@secpenalty}\addvspace{\@tempskipa}\fi \@ifstar
%     {\@ssect{#3}{#4}{#5}{#6}}{\@dblarg{\@nonumsect{#1}{#2}{#3}{#4}{#5}{#6}}}}
%
%\def\@nonumsect#1#2#3#4#5#6[#7]#8{\ifnum #2>\c@secnumdepth
%     \def\@svsec{}\else 
%%     \refstepcounter{#1}\edef\@svsec{\csname the#1\endcsname\hskip 1em }\fi
%     \refstepcounter{#1}\edef\@svsec{}\fi
%     \@tempskipa #5\relax
%      \ifdim \@tempskipa>\z@ 
%        \begingroup #6\relax
%          \@hangfrom{\hskip #3\relax\@svsec}{\interlinepenalty \@M #8\par}%
%        \endgroup
%       \csname #1mark\endcsname{#7}\addcontentsline
%         {toc}{#1}{\ifnum #2>\c@secnumdepth \else
%%                      \protect\numberline{\csname the#1\endcsname}\fi
%                      \protect\numberline{}\fi
%                    #8}\else
%        \def\@svsechd{#6\hskip #3\@svsec #8\csname #1mark\endcsname
%                      {#7}\addcontentsline
%                           {toc}{#1}{\ifnum #2>\c@secnumdepth \else
%%                             \protect\numberline{\csname the#1\endcsname}\fi
%                             \protect\numberline{}\fi
%                       #8}}\fi
%     \@xsect{#5}}
%
%\if@twoside \def\ps@headings{\let\@mkboth\markboth
%\def\@oddfoot{}\def\@evenfoot{}\def\@evenhead{\rm \thepage\hfil \sl
%\leftmark}\def\@oddhead{\hbox{}\sl \rightmark \hfil
%\rm\thepage}%
%\def\sectionmark##1{\markboth {\uppercase{##1}}{}}%
%\def\subsectionmark##1{\markright {##1}}%
%}\else \def\ps@headings{\let\@mkboth\markboth
%\def\@oddfoot{}\def\@evenfoot{}\def\@oddhead{\hbox {}\sl \rightmark \hfil
%\rm\thepage}%
%\def\sectionmark##1{\markright {\uppercase{##1}}}}
%\fi

\newif\ifcitehead
\newif\ifcitetail
\newif\iffirstcite
\newif\ifciteinparen

\def\@setfirstcite#1{%
  \@ifundefined{c@#1}{%
    \expandafter\gdef\csname c@#1\endcsname{}%
    \firstcitetrue%
  }{%
    \firstcitefalse%
    }%
  }

\def\@internalcite{%
  \@ifnextchar[{\citeheadtrue\@citegettail}{\citeheadfalse\@citegettail[]}}%
  \def\@citegettail[#1]{%
    \setbox\@tempboxa\hbox{#1}\ifdim \wd\@tempboxa >0pt\else\citeheadfalse\fi%
    \@ifnextchar[{\citetailtrue\@citex[#1]}{\citetailfalse\@citex[#1][]}}

\def\@citex[#1][#2]#3{%
  \if@filesw\immediate\write\@auxout{\string\citation{#3}}\fi%
  \def\@citeand{\ and\ }\def\@citea{}\def\@citepos{\def\@citeand{~\&\ }'\ (}%
  \def\@citeposs{\def\@citeand{~\&\ }'s\ (}%
  \def\@citeout{\def\@citeand{~\&\ }\ (}\def\@lastcite{}%
  \@cite{\@for\@citeb:=#3\do{%
    \@ifundefined{b@\@citeb}{{\@citeb}%
    \@warning{Citation `\@citeb' on page \thepage \space undefined}}%
    {\csname b@\@citeb\endcsname}}}{#1}{#2}}

\def\@citeand{\ifciteinparen~\&\ \else\ and\ \fi}

\def\@bocite#1#2{\ifcitehead#2\ \fi#1}
\def\@bccite#1#2{\def\@citeand{~\&\ }(\@bocite{#1}{#2}}
\def\@eocite#1{\ifcitetail, #1\fi}
\def\@eccite#1{\@eocite{#1})}

\def\@cite#1#2#3{\@bcite{#1}{#2}\@ecite{#3}}

\def\@ifempty#1#2#3{\def\arg{#1}\ifx\arg\empty#2\else#3\fi}

% This stuff allows short (name-less) citations, when used in
% conjunction with a bibliography style that creates labels like
%       \citename{<first name>}{<middle names>}{<last name>}{<label>}{<year>}{<key>}

\def\cite{%
  \def\citename##1##2##3##4##5##6{%
    \def\@thiscite{##1##2##3}%
    \ifx\@thiscite\@lastcite,\ ##5%
    \else%
      \@citea\def\@citea{;\ }\def\@lastcite{##1##2##3}%
      \@ifempty{##3}{##1}%
      {\@ifempty{##2}{##1~\&\ ##3}%
        {\@setfirstcite{##6}\iffirstcite##1,\ ##2,~\&\ ##3\else##1\ et~al.\fi}},\ ##5\fi}%
  \def\@bcite{\@bccite}\def\@ecite{\@eccite}\@internalcite}

\def\outcite{%
  \def\citename##1##2##3##4##5##6{%
    \def\@thiscite{##1##2##3}%
    \ifx\@thiscite\@lastcite,\ ##5%
    \else%
      \@citea\def\@citea{;\ }\def\@lastcite{##1##2##3}%
      \@ifempty{##3}{##1}%
      {\@ifempty{##2}{##1\@citeand##3}%
        {\@setfirstcite{##6}\iffirstcite##1,\ ##2,\@citeand##3\else##1\ et~al.\fi}}%
      \@citeout\def\@citeout{,\ }##5\fi}%
  \def\@bcite{\@bocite}\def\@ecite{\@eccite}\@internalcite}

\def\nopcite{%
  \def\citename##1##2##3##4##5##6{%
    \def\@thiscite{##1##2##3}%
    \ifx\@thiscite\@lastcite,\ ##5%
    \else%
      \@citea\def\@citea{;\ }\def\@lastcite{##1##2##3}%
      \@ifempty{##3}{##1}%
      {\@ifempty{##2}{##1~\&\ ##3}%
        {\@setfirstcite{##6}\iffirstcite##1,\ ##2,~\&\ ##3\else##1\ et~al.\fi}}%
      ,\ ##5\fi}%
  \def\@bcite{\@bocite}\def\@ecite{\@eocite}\@internalcite}

\def\poscite{%
  \def\citename##1##2##3##4##5##6{%
    \def\@thiscite{##1##2##3}%
    \ifx\@thiscite\@lastcite,\ ##5%
    \else%
      \@citea\def\@citea{;\ }\def\@lastcite{##1##2##3}%
      \@ifempty{##3}{##1}%
      {\@ifempty{##2}{##1\@citeand##3}%
        {\@setfirstcite{##6}\iffirstcite##1,\ ##2,\@citeand##3\else##1\ et~al.\fi}}%
      \@citepos\def\@citepos{,\ }##5\fi}%
  \def\@bcite{\@bocite}\def\@ecite{\@eccite}\@internalcite}

\def\posscite{%
  \def\citename##1##2##3##4##5##6{%
    \def\@thiscite{##1##2##3}%
    \ifx\@thiscite\@lastcite,\ ##5%
    \else%
      \@citea\def\@citea{;\ }\def\@lastcite{##1##2##3}%
      \@ifempty{##3}{##1}%
      {\@ifempty{##2}{##1\@citeand##3}%
        {\@setfirstcite{##6}\iffirstcite##1,\ ##2,\@citeand##3\else##1\ et~al.\fi}}%
      \@citeposs\def\@citeposs{,\ }##5\fi}%
  \def\@bcite{\@bocite}\def\@ecite{\@eccite}\@internalcite}

\def\yrcite{%
  \def\citename##1##2##3##4##5##6{\@citea\def\@citea{,\ }##5}%
  \def\@bcite{\@bccite}\def\@ecite{\@eccite}\@internalcite}

\def\yrnopcite{%
  \def\citename##1##2##3##4##5##6{\@citea\def\@citea{,\ }##5}%
  \def\@bcite{\@bocite}\def\@ecite{\@eocite}\@internalcite}

%
% always list all authors
%
\def\fullcite{%
  \def\citename##1##2##3##4##5##6{%
    \def\@thiscite{##1##2##3}%
    \ifx\@thiscite\@lastcite,\ ##5%
    \else%
      \@citea\def\@citea{;\ }\def\@lastcite{##1##2##3}%
      \@ifempty{##3}{##1}%
      {\@ifempty{##2}{##1~\&\ ##3}%
        {##1,\ ##2,~\&\ ##3}}%
      ,\ ##5\fi}%
  \def\@bcite{\@bccite}\def\@ecite{\@eccite}\@internalcite}

\def\fulloutcite{%
  \def\citename##1##2##3##4##5##6{%
    \def\@thiscite{##1##2##3}%
    \ifx\@thiscite\@lastcite,\ ##5%
    \else%
      \@citea\def\@citea{;\ }\def\@lastcite{##1##2##3}%
      \@ifempty{##3}{##1}%
      {\@ifempty{##2}{##1\@citeand##3}%
        {##1,\ ##2,\@citeand##3}}%
      \@citeout\def\@citeout{,\ }##5\fi}%
  \def\@bcite{\@bocite}\def\@ecite{\@eccite}\@internalcite}

\def\fullnopcite{%
  \def\citename##1##2##3##4##5##6{%
    \def\@thiscite{##1##2##3}%
    \ifx\@thiscite\@lastcite,\ ##5%
    \else%
      \@citea\def\@citea{;\ }\def\@lastcite{##1##2##3}%
      \@ifempty{##3}{##1}%
      {\@ifempty{##2}{##1~\&\ ##3}%
        {##1,\ ##2,~\&\ ##3}}%
      ,\ ##5\fi}%
  \def\@bcite{\@bocite}\def\@ecite{\@eocite}\@internalcite}

\def\fullposcite{%
  \def\citename##1##2##3##4##5##6{%
    \def\@thiscite{##1##2##3}%
    \ifx\@thiscite\@lastcite,\ ##5%
    \else%
      \@citea\def\@citea{;\ }\def\@lastcite{##1##2##3}%
      \@ifempty{##3}{##1}%
      {\@ifempty{##2}{##1\@citeand##3}%
        {##1,\ ##2,\@citeand##3}}%
      \@citepos\def\@citepos{,\ }##5\fi}%
  \def\@bcite{\@bocite}\def\@ecite{\@eccite}\@internalcite}

\def\fullposscite{%
  \def\citename##1##2##3##4##5##6{%
    \def\@thiscite{##1##2##3}%
    \ifx\@thiscite\@lastcite,\ ##5%
    \else%
      \@citea\def\@citea{;\ }\def\@lastcite{##1##2##3}%
      \@ifempty{##3}{##1}%
      {\@ifempty{##2}{##1\@citeand##3}%
        {##1,\ ##2,\@citeand##3}}%
      \@citeposs\def\@citeposs{,\ }##5\fi}%
  \def\@bcite{\@bocite}\def\@ecite{\@eccite}\@internalcite}

%
% always use et al.
%
\def\abbrevcite{%
  \def\citename##1##2##3##4##5##6{%
    \def\@thiscite{##1##2##3}%
    \ifx\@thiscite\@lastcite,\ ##5%
    \else%
      \@citea\def\@citea{;\ }\def\@lastcite{##1##2##3}%
      \@ifempty{##3}{##1}%
      {\@ifempty{##2}{##1~\&\ ##3}%
        {##1\ et~al.}}%
      ,\ ##5\fi}%
  \def\@bcite{\@bccite}\def\@ecite{\@eccite}\@internalcite}

\def\abbrevoutcite{%
  \def\citename##1##2##3##4##5##6{%
    \def\@thiscite{##1##2##3}%
    \ifx\@thiscite\@lastcite,\ ##5%
    \else%
      \@citea\def\@citea{;\ }\def\@lastcite{##1##2##3}%
      \@ifempty{##3}{##1}%
      {\@ifempty{##2}{##1\@citeand##3}%
        {##1\ et~al.}}%
      \@citeout\def\@citeout{,\ }##5\fi}%
  \def\@bcite{\@bocite}\def\@ecite{\@eccite}\@internalcite}

\def\abbrevnopcite{%
  \def\citename##1##2##3##4##5##6{%
    \def\@thiscite{##1##2##3}%
    \ifx\@thiscite\@lastcite,\ ##5%
    \else%
      \@citea\def\@citea{;\ }\def\@lastcite{##1##2##3}%
      \@ifempty{##3}{##1}%
      {\@ifempty{##2}{##1~\&\ ##3}%
        {##1\ et~al.}}%
      ,\ ##5\fi}%
  \def\@bcite{\@bocite}\def\@ecite{\@eocite}\@internalcite}

\def\abbrevposcite{%
  \def\citename##1##2##3##4##5##6{%
    \def\@thiscite{##1##2##3}%
    \ifx\@thiscite\@lastcite,\ ##5%
    \else%
      \@citea\def\@citea{;\ }\def\@lastcite{##1##2##3}%
      \@ifempty{##3}{##1}%
      {\@ifempty{##2}{##1\@citeand##3}%
        {##1\ et~al.}}%
      \@citepos\def\@citepos{,\ }##5\fi}%
  \def\@bcite{\@bocite}\def\@ecite{\@eccite}\@internalcite}

\def\abbrevposscite{%
  \def\citename##1##2##3##4##5##6{%
    \def\@thiscite{##1##2##3}%
    \ifx\@thiscite\@lastcite,\ ##5%
    \else%
      \@citea\def\@citea{;\ }\def\@lastcite{##1##2##3}%
      \@ifempty{##3}{##1}%
      {\@ifempty{##2}{##1\@citeand##3}%
        {##1\ et~al.}}%
      \@citeposs\def\@citeposs{,\ }##5\fi}%
  \def\@bcite{\@bocite}\def\@ecite{\@eccite}\@internalcite}


% some people perfer the name \incite to \outcite
\let\incite\outcite
\let\fullincite\fulloutcite
\let\abbrevincite\abbrevoutcite


% This makes the bibliography entries have no labels, and be
% outdented (first line is flush with left margin)

\def\@biblabel#1{}
\def\@lbibitem[#1]#2{\item[\@biblabel{#1}]\hskip -\leftmargin\if@filesw 
      {\def\protect##1{\string ##1\space}\immediate
        \write\@auxout{\string\bibcite{#2}{#1}}}\fi\ignorespaces}

%
% just changed to have \itemsep 0em
%

%%% !!! modified to \section*
\def\thebibliography#1{\section*{References}\list
 {[\arabic{enumi}]}{\settowidth\labelwidth{[#1]}\leftmargin\labelwidth
 \advance\leftmargin\labelsep\itemsep 0em
 \usecounter{enumi}}
 \def\newblock{\hskip .11em plus .33em minus .07em}
 \sloppy\clubpenalty4000\widowpenalty4000
 \sfcode`\.=1000\relax}
\let\endthebibliography=\endlist
%
% An untitled bibliography environment
%
\def\theuntitledbibliography#1{\list
  {\relax}{\labelsep 0em\itemindent 1.5em\leftmargin 3.5em}
    \def\newblock{\hskip .11em plus .33em minus .07em}
    \sloppy\clubpenalty4000\widowpenalty4000
    \sfcode`\.=1000\relax}
%
% for small headers inside theuntitledbibliography
%
\newcommand{\bibhead}[1]{\item \hspace*{-5em}{\normalsize\bf #1}}
